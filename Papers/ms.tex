\documentclass[useAMS,usenatbib]{mn2e}

\voffset=-0.8in

% Packages:
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{xspace}
%\usepackage{dsfont}
\usepackage[utf8]{inputenc}
\usepackage{caption}
\usepackage{subcaption} % subfigures
\usepackage{float}

\usepackage{epstopdf} 

\title[]
{Trans-Dimensional Inference for Gravitational Lens Substructures}
    
\author[Brewer, Huijser and Lewis]{%
  Brendon~J.~Brewer$^{1}$\thanks{bj.brewer@auckland.ac.nz},
  David Huijser$^{1}$,
  Geraint F. Lewis$^2$
  \medskip\\
  $^1$Department of Statistics, The University of Auckland, Private Bag 92019, Auckland 1142, New Zealand\\
  $^2$Sydney Institute for Astronomy, School of Physics, A28,
  The University of Sydney, NSW 2006, Australia}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
             
\date{To be submitted to MNRAS}
             
\maketitle

\label{firstpage}

\begin{abstract}
We introduce a Bayesian solution to the problem of inferring the density
profile of strong gravitational lenses when the lens galaxy may contain
multiple dark or faint substructures. The source and lens models are based on
a superposition of an unknown number of non-negative basis functions
(or ``blobs'') which were chosen with speed as a primary criterion.
The prior distribution for the blobs' properties is specified hierarchically,
so the ``mass function'' of substructures is a natural output. We use reversible
jump Markov Chain Monte Carlo (MCMC) within Diffusive Nested Sampling (DNS) to
sample the posterior distribution and evaluate the marginal likelihood of the
model. We demonstrate the method on a simulated data set, and also apply it to
the Cosmic Horseshoe, finding ...
\end{abstract}


\begin{keywords}
gravitational lensing --- methods: data analysis --- methods: statistical
\end{keywords}

\section{Introduction}
Galaxy-galaxy lensing is a powerful astrophysical tool for studying
the distribution of matter, including dark matter, in galaxies
\citep{treu}. It holds substantial potential as a technique for discovering
and measuring the properties of dark matter substructures \citep{koopmans}.
In recent years, this potential has been realised in several lens systems
which are thought to contain at least one dark substructure
\citep{vegetti1, vegetti2, vegetti3}. The present paper describes an
approach we have developed for the inverse problem of detecting dark
substructures from image data. However, it may also prove useful in other
galaxy-galaxy lens modelling areas, such as time-delay cosmography, which
requires realistically flexible lens models, and reliable uncertainty
quantification
\citep{2013ApJ...766...70S, 2014ApJ...788L..35S, grillo}.

In this paper we address the topic of
inferring the matter distribution in the lens galaxy from the lensed,
blurred image. These approaches may be categorized according to the following
criteria:
\begin{enumerate}
\item Whether to use a simply parameterized (e.g. Sérsic), moderately flexible
(e.g. mixture model, \citet{2011MNRAS.412.2521B})
or free-form (e.g. pixellated) model for the surface brightness profile of the source
\item Whether to use a simply parameterized (e.g. Singular Isothermal Ellipsoid)
or flexible model (e.g. pixellated) for the mass profile of the lens
\item How to compute the results (e.g. optimization methods, Markov Chain
Monte Carlo with or without source parameters marginalized out).
\end{enumerate}

Many different approaches have been proposed and applied to
this problem. Recent sophisicated approaches to
this problem include \citet{2014MNRAS.445.2181C},
\citet{2015arXiv150500198T}, and
\citet{2015arXiv150407629B}. {\bf todo: actually comment
on what's in these papers}.



The differences between the approaches can be broken down into
i) different assumptions about the prior information being used, and ii)
different computational methods used to compute the results.
Each approach involves tradeoffs between convenience and realism.
Simply parameterized models, such as Sérsic surface
brightness profiles for the source, and singular isothermal ellipsoid plus
external shear (SIE+$\gamma$) models for the lens, are very
convenient. They only have a few adjustable parameters, and they capture
(to ``first order'') relevant prior information that we have about the
source and lens profiles. Of course, they are clearly simplifications,
and can produce misleading results if the actual profile is very different
from any member of the assumed family.

On the
other hand, pixellated models for the source \citep[e.g.][]{suyu} or the lens
\citep[e.g.][]{2014MNRAS.445.2181C} can in principle represent ``any''
source surface brightness profile or lens projected density profile. However, the prior
distribution over pixel values is often chosen to be a multivariate gaussian
for mathematical reasons, so
that the source can be analytically marginalized over
\citep{2003ApJ...590..673W}. Unfortunately, a multivariate gaussian prior
over pixel intensities can correspond to a very poor model of our prior
beliefs about the source. It assigns virtually zero prior probability
to the hypothesis that the source actually looks like a galaxy, and very high
prior probability to the hypothesis that the source looks like noise (or
blurred noise). These priors also assign nonzero probability to negative
surface brightness or density values.

\citet{2011MNRAS.412.2521B} argued that an ideal
modelling approach lies somewhere between simply-parameterised and
pixellated models.
The source and the lens can be built up from a mixture of a moderate
number (from a few to a few hundred) of
simply parameterised components. For the source, this allows
us to incorporate prior knowledge about the local correlations (the surface
brightness at any particular point is likely to be similar to that at a
nearby point) and the fact that most of the sky is
dark \citep{2006ApJ...637..608B}. The main differences between the
\citet{2011MNRAS.412.2521B} and that of the present approach are:
i) we use a simpler and faster basis set, and ii) we apply it to the lens
as well as the source. However, in the present paper we do not account for
multi-band data.

For the lens, if we are interested in detecting and measuring the properties of
dark substructures, a superposition of an unknown number of ``blobs'' is the
most natural model. In addition, if we want to constrain the ``mass function'' of
these blobs, we will need a hierarchical model which specifies the probability
distribution for the masses, conditional on some hyperparameters. Inferring the
mass function of the blobs then reduces to calculating the posterior
distribution for the hyperparameters.

Computing the posterior distribution over the parameters of such a model
requires that we can implement Markov Chain Monte Carlo (MCMC) over the space
of possible sources and lenses.

\section{The Model}
We now describe the details of our model and its parameterization.


\subsection{The Source}
The surface brightness profile of the source is assumed to be composed of
a sum of a finite number of ``blobs'', or basis functions. The specific choice
of basis functions we use is motivated primarily by computational speed.
The surface brightness of a single blob centered at the origin
is:
\begin{eqnarray}
f(x, y) &=& \left\{
\begin{array}{lr}
\frac{A}{2\pi w^2}\left[1 - \left(\frac{r}{w}\right)^2\right], & r \leq w\\
0, & \textnormal{otherwise}
\end{array}
\right.
\end{eqnarray}
where $r = \sqrt{x^2 + y^2}$, $w$ is the width of the blob, and $A$ is the
total flux of the blob (i.e. the integral of the surface brightness over the
entire domain).
These basis functions are faster to evaluate than gaussians, since they do not
contain an exponential function. In addition, the finite support means that
each blob will evaluate to zero over a large fraction of the domain which
confers an additional speed advantage.

If our model contains $N_{\rm src}$ such blobs, positioned at
$\left\{(x_i^{\rm src}, y_i^{\rm src})\right\}$ with widths $\{w_i\}$ and total fluxes
$\{A_i\}$, the overall surface brightness profile is:
\begin{eqnarray}
f(x, y) &=& \sum_{i=1}^{N_{\rm src}}\left\{
\begin{array}{lr}
\frac{A_i}{2\pi w_i^2}\left[1 - \left(\frac{r_i}{w_i}\right)^2\right], & r_i \leq w_i\\
0, & \textnormal{otherwise}
\end{array}
\right.
\end{eqnarray}
where $r_i = \sqrt{(x - x_i^{\rm src})^2 + (y - y_i^{\rm src})^2}$.

Under these assumptions, the source can be described by the following
parameters:

\begin{eqnarray}
\left\{
N_{\rm src}, \left\{\boldsymbol{x}^{\rm src}_i\right\}_{i=1}^N
\right\}
\end{eqnarray}
where $\boldsymbol{x}^{\rm src}_i$ denotes the parameters for source blob $i$:
\begin{eqnarray}
\boldsymbol{x}^{\rm src}_i &=& \left\{x_i, y_i, A_i, w_i
\right\}.
\end{eqnarray}


\subsection{The Lens}
The surface mass density profile of the lens is modelled as a superposition
of a singular isothermal ellipsoid plus external shear (SIE+$\gamma$) and
$N$ circular lens ``blobs''. The SIE+$\gamma$ is a simple and widely used lens
model with analytically available deflection angles, and is intended to account
for the bulk of the lensing effect due to the smooth spatial distribution
of (visible and dark) matter in the lens galaxy. Unfortunately, along with
simplicity comes a lack of realism, and generalising the smooth lens model
is an important future step. Ultimately, concentric
mixtures of smooth components may be the most useful for realistic inference
of the density profile of the halo.

The SIE+$\gamma$ has nine free parameters:
the (circularized) einstein radius $b$, axis ratio $q$, central position
$(x_c, y_c)$, orientation angle $\theta$, the external shear $\gamma$, and the
orientation angle of the external shear, $\theta_{\gamma}$.

The $N$ lens blobs are intended to model possible dark or faint substructures
in the projected mass profile of the lens.
A lensing blob with mass $M$ and width $v$
centered at the origin has the following surface mass density profile:
\begin{eqnarray}
\rho(x, y) &=& \left\{
\begin{array}{lr}
\frac{M}{2\pi v^2}\left[1 - \left(\frac{r}{v}\right)^2\right], & r \leq v\\
0, & \textnormal{otherwise}
\end{array}
\right.
\end{eqnarray}
The deflection angles are:

%Menc = 4.*components[i][2]/widthsq*(0.5*rsq -
%				rsq*rsq/(4*widthsq));

\begin{eqnarray}
\alpha_x(x, y) &=&
\left\{
\begin{array}{lr}
-\frac{\left[2(r/v)^2 - (r/v)^4\right]Mx}{r^3}, & r \leq v\\
-\frac{Mx}{\pi r^3}, & \textnormal{otherwise}
\end{array}
\right.\\
\alpha_y(x, y) &=&
\left\{
\begin{array}{lr}
-\frac{\left[2(r/v)^2 - (r/v)^4\right]My}{r^3}, & r \leq v\\
-\frac{My}{\pi r^3}, & \textnormal{otherwise}
\end{array}
\right.
\end{eqnarray}


Since the model is not of fixed dimension (the number of source and lens
``blobs'' is unknown), we used a trans-dimensional MCMC sampler based on
reversible jump MCMC \citep{green}. We implemented the MCMC using the
{\tt RJObject} software \citep{rjobject}, a C++ library for implementing trans-dimensional
MCMC with hierarchically-specified priors, and doing the sampling with the
Diffusive Nested Sampling algorithm \citep{dnest}. Previous astronomical
applications of {\tt RJObject} include \citet{magnetron}
and~\citep{exoplanet}. Proposal moves for the parameters (positions and masses
of the source and lens blobs), and birth/death moves to add or remove blobs
to the source or lens, are handled internally by {\tt RJObject}.


\section{Prior Probability Distributions}
The prior probability distributions for all hyperparameters, parameters, and
the data, are given in Table~\ref{tab:priors}, and a factorization of the
joint distribution is displayed in Figure~\ref{fig:pgm}. With these priors,
we aim to express a large degree of prior uncertainty (hence the liberal use
of uniform, loguniform, and Cauchy distributions). However, we also specify
some priors hierarchically to allow (for example)
blobs to cluster around a typical central
position, rather than implying a high probability for substructure positions
being spread uniformly (in a frequency sense) over the sky. We also applied
hierarchical priors to the substructure masses (and fluxes) so that, while
the typical order of magnitude of the masses is unknown, the masses
themselves are likely to be roughly the same order of magnitude.

\begin{table*}
\begin{tabular}{|l|l|l|}
\hline
Quantity	&	Meaning		& Prior\\
\hline
{\bf Hyperparameters}\\
\hline
$N_{\rm src}$	&	Number of source blobs	& Uniform($0, 1, ..., 100$)\\
$N_{\rm lens}$	&	Number of lens blobs	& Uniform($0, 1, ..., 10$)\\
$(x_c^{\rm src}, y_c^{\rm src})$ & Typical position of source blobs & iid Cauchy(location=$(0,0)$, scale=0.1$\times$(image width))\\
$(x_c^{\rm lens}, y_c^{\rm lens})$ & Typical position of lens blobs & iid Cauchy(location=$(0,0)$, scale=0.1$\times$(image width))\\
$R_{\rm src}$   &	Typical distance of source blobs from $(x_c^{\rm src}, y_c^{\rm src})$ & LogUniform(0.01$\times$(image width), 10$\times$(image width))\\
$R_{\rm lens}$  &	Typical distance of lens blobs from $(x_c^{\rm lens}, y_c^{\rm lens})$ 	& LogUniform(0.01$\times$(image width), 10$\times$(image width))\\
$\mu_{\rm src}$ &	Typical flux of source blobs	& $\ln(\mu_{\rm src}) \sim$ Cauchy(0, 1)$T(-21.205, 21.205)$\\
$\mu_{\rm lens}$&	Typical mass of lens blobs	& $\ln(\mu_{\rm lens}) \sim$ Cauchy(0, 1)$T(-21.205, 21.205)$\\
$W_{\rm max}^{\rm src}$ &		Maximum width of source blobs	& LogUniform(0.001$\times$(image width), image width)\\
$W_{\rm min}^{\rm src}$ &		Minimum width of source blobs	& Uniform(0, $W_{\rm max}^{\rm src}$)\\
$W_{\rm max}^{\rm lens}$ &		Maximum width of lens blobs	& LogUniform(0.001$\times$(image width), image width)\\
$W_{\rm min}^{\rm lens}$ &		Minimum width of lens blobs	& Uniform(0, $W_{\rm max}^{\rm lens}$)\\
\hline
{\bf Source Blob Parameters}\\
\hline
$(x_i^{\rm src}, y_i^{\rm src})$ & Blob position & Circular(location=$(x_c^{\rm src}, y_c^{\rm src})$, scale=$R_{\rm src}$)\\
$A_i$  & Blob flux & Exponential(mean=$\mu_{\rm src}$)\\
$w_i$  & Blob width & Uniform($W_{\rm min}^{\rm src}$, $W_{\rm max}^{\rm src}$)\\
\hline
{\bf Lens Blob Parameters}\\
\hline
$(x_i^{\rm lens}, y_i^{\rm lens})$ & Blob position & Circular(location=$(x_c^{\rm lens}, y_c^{\rm lens})$, scale=$R_{\rm lens}$) \\
$M_i$  & Blob mass & Exponential(mean=$\mu_{\rm lens}$)\\
$v_i$  & Blob width & Uniform($W_{\rm min}^{\rm src}$, $W_{\rm max}^{\rm src}$)\\
\hline
{\bf Smooth Lens Parameters}\\
\hline
$b$ & SIE Einstein Radius & LogUniform(0.001$\times$(image width), image width)\\
$q$ & Axis ratio & Uniform(0, 0.95)\\
$(x_c^{\rm SIE}, y_c^{\rm SIE})$ & Central position & iid Cauchy(location=$(0,0)$, scale=0.1$\times$(image width))\\
$\theta$ & Orientation angle & Uniform$(0, \pi)$\\
$\gamma$ & External shear & Cauchy$(0, 0.05)T(0, \infty)$\\
$\theta_\gamma$ & External shear angle & Uniform$(0, \pi)$\\
\hline
{\bf Noise Parameters}\\
\hline
$\sigma_0$ & Constant component of noise variance & $\ln(\sigma_0) \sim$ Cauchy(0, 1)$T(-21.205, 21.205)$\\
$\sigma_1$ & Proportionality coeff. for variance incr. with flux &
$\ln(\sigma_1) \sim$ Cauchy(0, 1)$T(-21.205, 21.205)$\\
\hline
{\bf Data}\\
\hline
$D_{ij}$ & Pixel intensities & Normal$(m_{ij}, s_{ij}^2 + \sigma_0^2 + \sigma_1m_{ij})$
\end{tabular}
\caption{The prior distribution for all hyperparameters, parameters, and the
data, in our model. Uniform$(a, b)$ is a uniform
distribution between $a$ and $b$. LogUniform$(a, b)$ is a log-uniform
distribution (with density $f(x) \propto 1/x$, sometimes erroneously called
a Jeffreys prior) between $a$ and $b$. The notation $T(\alpha, \beta)$ after
a distribution denotes truncation to the interval $[\alpha, \beta]$.
\label{tab:priors}}
\end{table*}

We assign somewhat informative Cauchy priors to the central positions of the
source and the lens.
One might object to the Cauchy priors
for the central positions (and argue instead for gaussians) on the
basis that they do not have rotational symmetry. However, the priors we
are assigning are prior only to the values of the data pixel intensities only,
and not other facts about the data, such as its dimensions in arc seconds, or its
rectangular shape. Given these, there is no reason to insist on rotational
symmetry. The Cauchy priors are intended to enhance the plausibility
(relative to what a uniform prior would imply) that the
lens and source are somewhere near the centre of the image, but in a cautious
way.

The ``circular'' conditional prior for the blob positions has the following
density:
\begin{eqnarray}
\rho(x, y)\, dx \, dy &=&
\frac{1}{2\pi W} \frac{1}{r}\exp\left(-\frac{r}{W}\right) \, dx \, dy
\end{eqnarray}
where $r = \sqrt{(x-x_c)^2 + (y-y_c)^2}$. This results from an exponential
distribution (with expectation $W$) for the radial coordinate and a uniform distribution for the angular coordinate in plane polar coordinates. This was
chosen (as opposed to a more ``obvious'' choice such as a normal distribution)
for computational reasons: the {\tt RJObject} code requires a function to
transform from Uniform(0, 1) distributions to this distribution and back, and
the normal would have required the use of special functions.

\begin{figure*}
\includegraphics{pgm.pdf}
\caption{A probabilistic graphical model (PGM) of the dependence structure
of the prior information.\label{fig:pgm}}
\end{figure*}


\section{The Cosmic Horseshoe}
As a demonstration the method is the applied to the Cosmic Horseshoe INT data. 
The field of view of the image is $15.3180" \times 15.3180"$, and the size is $46 \times 46$ pixels, therefore one pixel is equivalent to $0.33"$. \\
The method discussed  in the previous section is applied to two models, the first model consist of a flexible source and a Singular Isothermal Elliptical(SIE) model for the lens. This model is has been used often  \cite{Dye2008}, \cite{schneider_falcoa_Ehlers_1994},      . 
The second model has in addition to the flexible source and SIE, also possible satellites. \\
The amount of added satellites is automatically determined by the program. If models the addition of an satellite galaxies gives a higher probability it will be preferred over then model without satellite galaxies.  \\
In both models the SIE is specified by the usual parameters: the location of the SIE ($x_c$,$y_c$), b, axis ratio $f$\footnote{in the code denoted with $q$},  the core radius$\zeta$, $\theta$, shear $\gamma$, and $\theta_{\gamma}$ \cite{kormann_schneider_1994}.\\

 \begin{figure*}
% \hspace{20pt}
\begin{subfigure}{.45\textwidth}
  \centering
  \includegraphics[width=0.75\linewidth,angle=90]{log_mass_SIE_no_blobs.eps}
\parbox{0.8\linewidth}{\caption{The log of the SIE mass within the critical curve  for model A.  \label{fig:sub1} }}
\end{subfigure}%
\begin{subfigure}{.45\textwidth}
  \centering
  \includegraphics[width=0.75\linewidth,angle=90]{log_mass_SIE.eps}
   \parbox{0.8\linewidth}{\caption{The log of the SIE mass within the critical curve for model B.   \label{fig:sub2}}}
\end{subfigure}
   \end{figure*}

After choosing the prior probabilities one has to initialized the Dnest-code, which mean incorporating the problem specific information for
 example dimensions of the images in pixels, image size in arc-seconds, information on the PSF etc in the metadata file. 
 Besides these problem specific parameters, there are also several other parameters concerning the performance of code which need to be
  edited in the OPTION file. After these initialization, we ran a test run to explore the amount of necessary levels, and length of the run.
 A sufficiently amount of levels correlates with good degree of mixing, and the length of the run is associated with the larger sample
  size. After one test run, the amount levels was adapted to 120, and the amount iterations was change to 5000 iterations, for model A this resulted in the effective sample size of 940, and for model B this resulted in the effective sample size of 757.  The difference between the effective sample size is not unexpected, since the probability space which can be explored by applying model B much larger.  \\
Throughout the paper the standard cosmology was used for the analysis:  $H_0=70 \rm{km~s^{-1} ~pc^{-1}}$,  $\Omega_m = 0.3$,and  $\Omega_\Lambda= 0.7$. 
The first test would to compare the SIE-mass of the models with the mass obtained in previous  work \cite{Belokurov2007} \cite{Dye2008}.
Using model A the median  calculated SIE mass within the critical curve in solar masses is  $(5.34 \pm 0.046) \cdot 10^{12} M_\odot$, % (using median + STDDEV)
which is comparable with previous work which gave the enclosed (cylindriacal) mass $(5.4 \pm 0.09) \cdot 10^{12} M_\odot$ \cite{Belokurov2007} and  mass within the Einstein-ring $(5.02 \pm 0.09) \cdot 10^{12} M_\odot$ \cite{Dye2008}. Figure \ref{fig:sub1} displays the histogram of the enclosed mass within an Einstein ring of $5"$, it displays a very well confined probability distribution of the mass. \\ 
Using model B the median calculated SIE mass within the critical curve in solar masses is  $(5.34 \pm 0.046) \cdot 10^{12} M_\odot$, % (using median + STDDEV)
which is slightly smaller compared to the masses obtained with model A and the masses from previous work mentioned above. Which is also not unexpected, because models where the SIE-mass is smaller can compensate by adding a satellite near by. Therefore the distribution is much wider as one can see in figure \ref{fig:sub2}. The median of the SIE-mass in model B is $(4.79 \pm 1.66) \cdot 10^{12} M_\odot$, which leaves a large numerical uncertainty. However by comparison of the two histograms in figure \ref{fig:1} it is apparent that the distribution has a strong feature at the location. \\
 
\begin{figure}[!h]
\hspace{5pt}
\begin{subfigure}{.45\textwidth}
  \centering
  \includegraphics[width=0.7\linewidth,angle=90]{log_total_mass_blob.eps}
\parbox{0.8\linewidth}{\caption{The log of the total mass of the satellites for model B.   \label{fig:sub3}}}
\end{subfigure}%
\hspace{-15pt}
\begin{subfigure}{.45\textwidth}
  \centering
  \vspace{6pt}
  \includegraphics[width=0.7\linewidth,angle=90]{log_total_mass_blobs_within_ring.eps}
\parbox{0.8\linewidth}{\caption{The log of the total mass of the satellites within the fixed Einstein-radius for model B.  \label{fig:sub4} }}
\end{subfigure}
   \end{figure}
\vspace{-15pt}
\noindent Another interesting aspect is the mass of the satellites. Figure \ref{fig:sub3} displays a histogram of the logarithm of the total mass of the satellites per sample. Figure \ref{fig:sub4} displays histogram of the logarithm of the total mass of the satellites within a radius of $ 5"$ from the centre of images per sample. Comparing these two images reveals that large part the massive satellites lie outside the Einstein ring. The satellites at a larger distance can only influence the images if they are more massive. Figure \ref{fig:sub5} display a histogram of the log of the total mass of the SIE and the satellites within the Einstein radius, which clearly looks very similar to \ref{fig:sub1}. 
Figure \ref{fig:sub6} display a plot of the total mass of the SIE versus mass of the satellites within the Einstein radius whichs  negative correlation of approximately 
\begin{equation}
 \sum M_{satellites} = 5\cdot10^{12} - M_{SIE}
 \end{equation}

The main conclusion of the analysis of the datasets of model A and model B, would be that the application of the DNest code with a free amount of satellite galaxies return a well matching model which is very similar to to the model without any satellites, this proves 
even though the code has the freedom the explore and create all sort of models, it confirms that the already known distribution is very probable. This shows how well the code works, and beside that it is also good indication that the well established SIE model for this system doesn't need additional satellites to explain the system. 
 
\begin{figure}
\hspace{10pt}
\begin{subfigure}{.5\textwidth}
\vspace{-12pt}
  \centering
  \includegraphics[width=0.75\linewidth,angle=90]{mass_SIE_plus_blob_mass.eps}
\parbox{0.8\linewidth}{\caption{The log of add mass of the satellites and SIE within the fixed Einstein-radius for model B.   \label{fig:sub5}}}
\end{subfigure}
\begin{subfigure}{.5\textwidth}
  \centering
  \includegraphics[width=0.75\linewidth,angle=90]{joint.eps}
\parbox{0.8\linewidth}{\caption{Plot of the log of the total mass of the satellites within the fixed Einstein-radius versus the 
log of the SIE mass within the Einstein radius for model B.  \label{fig:sub6} }}
\end{subfigure}

   \end{figure}

  
  

\section{ER 0047-2808}
We demonstrate the method on the HST images of ER 0047-2808.



\section*{Acknowledgements}
It is a pleasure to thank Phil Marshall (Stanford) and Tommaso Treu (UCLA)
for valuable discussion.

This work was funded by a Marsden Fast Start grant from the Royal Society of
New Zealand.


\begin{thebibliography}{99}
\bibitem[\protect\citeauthoryear{Birrer, Amara, 
\& Refregier}{2015}]{2015arXiv150407629B} Birrer S., Amara A., Refregier A., 2015, arXiv, arXiv:1504.07629

\bibitem[\protect\citeauthoryear{Brewer 
\& Lewis}{2006}]{2006ApJ...637..608B} Brewer B.~J., Lewis G.~F., 2006, ApJ, 637, 608

\bibitem[\protect\citeauthoryear{Brewer, P{\'a}rtay,
\& Cs{\'a}nyi}{2011}]{dnest} Brewer B.~J., P{\'a}rtay L.~B., Cs{\'a}nyi G., 2011,
Statistics and Computing, 21, 4, 649-656. arXiv:0912.2380

\bibitem[\protect\citeauthoryear{Brewer et al.}{2011}]{2011MNRAS.412.2521B} 
Brewer B.~J., Lewis G.~F., Belokurov V., Irwin M.~J., Bridges T.~J., Evans 
N.~W., 2011, MNRAS, 412, 2521

\bibitem[\protect\citeauthoryear{Brewer}{2014}]{rjobject} Brewer, B. J., 2014,
preprint. ArXiv: 1411.3921

\bibitem[\protect\citeauthoryear{Brewer 
\& Donovan}{2015}]{exoplanet} Brewer B.~J., Donovan C.~P., 2015, MNRAS, 448, 3206 

\bibitem[\protect\citeauthoryear{Coles, Read, 
\& Saha}{2014}]{2014MNRAS.445.2181C} Coles J.~P., Read J.~I., Saha P., 2014, MNRAS, 445, 2181

\bibitem[\protect\citeauthoryear{Green}{1995}]{rjmcmc}
Green, P.~J., 1995, Reversible Jump Markov Chain Monte Carlo Computation and Bayesian Model Determination, Biometrika 82 (4): 711–732.

\bibitem[\protect\citeauthoryear{Grillo et al.}{2015}]{grillo} 
Grillo C., et al., 2015, ApJ, 800, 38 

\bibitem[\protect\citeauthoryear{Huppenkothen et 
al.}{2015}]{magnetron} Huppenkothen D., et al., 2015, arXiv, 
arXiv:1501.05251 

\bibitem[\protect\citeauthoryear{Koopmans}{2005}]{koopmans} 
Koopmans L.~V.~E., 2005, MNRAS, 363, 1136

\bibitem[\protect\citeauthoryear{O'Hagan and Forster}{2004}]{ohagan}
O'Hagan, A., Forster,~J., 2004, Bayesian inference. London: Arnold.

\bibitem[\protect\citeauthoryear{Sivia \& Skilling}{2006}]{sivia} Sivia, 
D.~ S., Skilling, J., 2006, Data Analysis: A Bayesian Tutorial, 2nd 
Edition, Oxford University Press

\bibitem[\protect\citeauthoryear{Skilling}{2006}]{skilling} Skilling, 
J., 2006, ``Nested Sampling for General Bayesian Computation'', Bayesian 
Analysis 4, pp. 833-860

\bibitem[\protect\citeauthoryear{Suyu et al.}{2006}]{suyu} 
Suyu S.~H., Marshall P.~J., Hobson M.~P., Blandford R.~D., 2006, MNRAS, 
371, 983

\bibitem[\protect\citeauthoryear{Suyu et al.}{2014}]{2014ApJ...788L..35S} 
Suyu S.~H., et al., 2014, ApJ, 788, L35 

\bibitem[\protect\citeauthoryear{Suyu et al.}{2013}]{2013ApJ...766...70S} 
Suyu S.~H., et al., 2013, ApJ, 766, 70 

\bibitem[\protect\citeauthoryear{Tagore 
\& Jackson}{2015}]{2015arXiv150500198T} Tagore A.~S., Jackson N., 2015, arXiv, arXiv:1505.00198

\bibitem[\protect\citeauthoryear{Treu}{2010}]{treu} Treu T., 2010, ARA\&A, 48, 87 

\bibitem[\protect\citeauthoryear{Vegetti et 
al.}{2012}]{vegetti1} Vegetti S., Lagattuta D.~J., McKean J.~P., 
Auger M.~W., Fassnacht C.~D., Koopmans L.~V.~E., 2012, Natur, 481, 341 

\bibitem[\protect\citeauthoryear{Vegetti et 
al.}{2010}]{vegetti2} Vegetti S., Koopmans L.~V.~E., Bolton A., 
Treu T., Gavazzi R., 2010, MNRAS, 408, 1969 

\bibitem[\protect\citeauthoryear{Vegetti, Czoske, 
\& Koopmans}{2010}]{vegetti3} Vegetti S., Czoske O., Koopmans L.~V.~E., 2010, MNRAS, 407, 225

\bibitem[\protect\citeauthoryear{Warren 
\& Dye}{2003}]{2003ApJ...590..673W} Warren S.~J., Dye S., 2003, ApJ, 590, 673
\end{thebibliography}


\end{document}

